:root {
  /* verde sobrio del sito */
  --brand:#1e7f4a;         /* primario */
  --brand-weak:#eaf7f0;    /* sfondo lieve */
  --brand-line:#cfe9db;    /* contorno lieve */

  --bg:#fff; --ink:#111; --muted:#555; --soft:#f6f8f7;
  --line:#e6e9e7; --green:#20a35b; --red:#d64545;
  --radius:14px;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:Lato,system-ui,sans-serif;}
h1,h2{font-family:"Playfair Display",serif;}
.muted{color:var(--muted)}
.small{font-size:.9rem}

/* ===================== Header ===================== */
.dl-header{
  position:sticky;
  top:0;
  background:var(--bg);
  border-bottom:1px solid var(--line);
  padding:.9rem 1rem;
  z-index:50;                 /* sopra la sidebar */
  min-height:72px;
}
.dl-header .brand{
  display:flex;
  gap:.75rem;
  align-items:center;
}
/* icona (a fianco del titolo) più grande */
.home-link{display:inline-block;border-radius:10px;text-decoration:none;color:var(--ink);cursor:pointer}
.home-link img{
  height:56px;               /* prima era 30px */
  display:block;
}
@media (max-width:640px){
  .home-link img{height:48px}
}
.dl-header h1{margin:0;font-size:1.6rem;line-height:1}

/* ===================== Main blocks ===================== */
.dl-main{max-width:1200px;margin:1rem auto;padding:0 1rem 2rem}
.block{margin:1rem 0;padding:1rem;border:1px solid var(--brand-line);border-radius:var(--radius);background:#fff}
.block-title{margin:.2rem 0 1rem 0;font-size:1.1rem}

/* riga con 2 colonne */
.two-col{display:grid;grid-template-columns:1fr 1fr;gap:1rem}

/* dataset chooser */
.dataset-chooser{display:flex;gap:.5rem;flex-wrap:wrap}
.ds-btn{border:1px solid var(--brand-line);background:var(--soft);padding:.45rem .8rem;border-radius:999px;cursor:pointer;font-weight:600}
.ds-btn[aria-pressed="true"]{background:var(--brand-weak);border-color:var(--brand);color:#0f5b36}

/* chips area (regions/provinces) */
.chips-col h3{margin:.25rem 0 .5rem 0;font-size:1rem}
.chips{display:flex;flex-wrap:wrap;gap:.4rem}
.chip{padding:.33rem .6rem;border-radius:999px;border:1px solid var(--brand-line);background:var(--soft);cursor:pointer}
.chip.active{background:var(--brand-weak);border-color:var(--brand)}
.chips-ops{margin-top:.5rem;display:flex;gap:.4rem}
.chip-op{background:transparent;border:1px solid var(--brand-line);border-radius:8px;padding:.25rem .5rem;cursor:pointer}
.chip-op:hover{border-color:var(--brand)}

/* fields bar */
.fields-bar{display:flex;flex-wrap:wrap;gap:.4rem}
.field-pill{padding:.35rem .6rem;border-radius:999px;border:1px solid var(--brand-line);cursor:pointer;font-weight:600}
.field-pill.on{background:var(--brand-weak);border-color:var(--brand);color:#0a6a3c}   /* verde */
.field-pill.off{background:#fff5f5;border-color:#ffdede;color:#a12e2e}                 /* rosso */

/* ===================== Table + actions ===================== */
.table-head{display:flex;align-items:center;justify-content:space-between;gap:1rem;margin-bottom:.6rem}
.table-actions{display:flex;gap:.5rem;align-items:center}
.search-input{border:1px solid var(--brand-line);border-radius:10px;padding:.45rem .6rem;min-width:220px}
.download-btn{border:0;background:var(--brand);color:#fff;padding:.5rem .8rem;border-radius:10px;font-weight:700;cursor:pointer}
.download-btn.outline{background:transparent;color:var(--brand);border:1px solid var(--brand)}
.download-btn:hover{filter:brightness(.95)}
.rows-label{font-size:.9rem;display:flex;gap:.35rem;align-items:center}
.rows-label select{border:1px solid var(--brand-line);border-radius:8px;padding:.25rem .4rem}

.table-wrap{overflow:auto;border:1px solid var(--brand-line);border-radius:12px}
table{border-collapse:separate;border-spacing:0;width:100%}
thead th{
  position:sticky;top:0;background:#fafafa;border-bottom:1px solid var(--brand-line);
  padding:.6rem .5rem;text-align:left;font-weight:700;border-right:1px solid var(--brand-line);
}
thead th:last-child{border-right:none}
tbody td{
  border-bottom:1px solid #edf1ee;
  padding:.5rem .5rem;vertical-align:top;border-right:1px solid var(--brand-line)
}
tbody td:last-child{border-right:none}
tbody tr:hover{background:#fbfffc}
.no-results{padding:.9rem;color:var(--muted);text-align:center}

.pager{display:flex;gap:.75rem;align-items:center;justify-content:flex-end;margin-top:.6rem}
.pg-btn{border:1px solid var(--brand-line);background:#fff;border-radius:8px;padding:.35rem .6rem;cursor:pointer}
.pg-btn:disabled{opacity:.5;cursor:not-allowed}
.page-info{color:var(--muted)}

/* ===================== Footer ===================== */
.dl-footer{border-top:1px solid var(--line);padding:1rem;text-align:center;color:var(--muted)}

/* ===================== Right filters sidebar ===================== */
.rf{
  position: fixed;
  top: 96px;                /* sotto l’header sticky */
  right: 16px;
  width: 320px;
  max-height: calc(100vh - 112px);
  overflow:auto;
  padding: 12px;
  background: #fff;
  border: 1px solid var(--brand-line);
  border-radius: 14px;
  box-shadow: 0 8px 24px rgba(0,0,0,.08);
  z-index: 40;              /* sotto l’header */
}
.rf-block{border:1px solid var(--brand-line);border-radius:12px;padding:.75rem;margin-bottom:.75rem;background:#fff}
.rf-head{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-bottom:.5rem}
.rf-head h3{margin:0;font-size:1rem}
.rf-ops{display:flex;gap:.35rem}
.rf-op{border:1px solid var(--brand-line);background:transparent;border-radius:8px;padding:.25rem .5rem;cursor:pointer}
.rf-chips{display:flex;flex-wrap:wrap;gap:.35rem}
.rf-chip{padding:.28rem .55rem;border-radius:999px;border:1px solid var(--brand-line);background:var(--soft);cursor:pointer}
.rf-chip.active{background:var(--brand-weak);border-color:var(--brand)}

/* restringi main per non sovrapporsi alla sidebar */
@media (min-width: 1100px){
  .dl-main{margin-right:360px}
}

/* ===================== Taxa widget “ricco” (icone + popover) ===================== */
.tx-head{display:flex;gap:.4rem;align-items:center;margin-bottom:.5rem}
#taxaFilterMount .search-input{border:1px solid var(--brand-line);border-radius:10px;padding:.45rem .6rem;min-width:0;flex:1}
#taxaFilterMount .rf-op{border:1px solid var(--brand-line);background:transparent;border-radius:8px;padding:.25rem .5rem;cursor:pointer}

.tx-list{
  display:grid;
  grid-template-columns:repeat(3, minmax(0,1fr));
  gap:.5rem;
  max-height:360px;
  overflow:auto;
  border:1px solid var(--brand-line);
  border-radius:10px;
  padding:.6rem;
}
.tx-family{display:flex;flex-direction:column;gap:.4rem}
.tx-family h4{margin:.1rem 0;font-size:.92rem;color:#0f5b36}
.tx-row{display:flex;flex-wrap:wrap;gap:.35rem}

/* chip rotonda con icona */
.tx-chip{
  display:inline-flex;align-items:center;justify-content:center;
  width:48px;height:48px;border-radius:50%;
  border:2px solid rgba(34,197,94,0.45);
  background:#fff; cursor:pointer; padding:0; overflow:hidden;
  transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
}
.tx-chip img{width:100%;height:100%;object-fit:cover;display:block}
.tx-chip.active{border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,0.18) inset}
.tx-chip:hover{transform:scale(1.05)}

/* popover taxa */
.tx-pop{
  position: fixed;
  display:none;
  flex-direction:column;
  gap:8px;
  padding:10px;
  background:#fff;
  border:2px solid #22c55e;
  border-radius:12px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  z-index:60;
  min-width:220px;
}
.tx-pop h5{margin:0;font-size:.9rem;color:#065f46}
.tx-pop-grid{display:flex;flex-wrap:wrap;gap:8px}

/* responsive griglia taxa */
@media (max-width: 1200px){
  .tx-list{grid-template-columns:repeat(2, minmax(0,1fr))}
}
@media (max-width: 980px){
  .tx-list{grid-template-columns:1fr}
}

/* ===================== Misc responsive ===================== */
@media (max-width: 820px){
  .two-col{grid-template-columns:1fr}
  .dl-main{margin-right:0}
  .rf{position:static;width:auto;max-height:none;box-shadow:none;margin:0 1rem}
}

/* —— Suggerimenti ricerca taxa —— */
.tx-suggest{
  position: relative;
  margin-top:.35rem;
  border:1px solid var(--brand-line);
  border-radius:10px;
  background:#fff;
  max-height:240px;
  overflow:auto;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
}
.tx-sug-row{
  width:100%;
  display:flex; align-items:center; gap:.5rem;
  padding:.4rem .55rem;
  background:transparent;
  border:0; cursor:pointer;
  border-bottom:1px solid #eff5f1;
}
.tx-sug-row:last-child{border-bottom:0}
.tx-sug-row:hover{background:var(--brand-weak)}
.tx-sug-icn{width:28px;height:28px;border-radius:50%;object-fit:cover;border:1px solid var(--brand-line)}
.tx-sug-lab{flex:1; text-align:left}
.tx-sug-meta{font-size:.8rem; color:var(--muted);}

/* —— Chip selezionate (precise_taxon) —— */
.sel-chips{display:flex;flex-wrap:wrap;gap:.35rem;margin-top:.45rem}
.sel-chip{
  display:inline-flex; align-items:center; gap:.4rem;
  padding:.25rem .5rem; border-radius:999px;
  border:1px solid var(--brand-line); background:var(--brand-weak);
  cursor:pointer;
}
.sel-chip img{width:20px;height:20px;border-radius:50%;object-fit:cover;border:1px solid var(--brand-line)}
.sel-chip .sel-x{font-weight:800; opacity:.7}

/* —— Bottone verde "explore all taxa" —— */
.explore-btn{
  border:1px solid var(--brand); background:var(--brand);
  color:#fff; border-radius:10px; padding:.45rem .6rem; font-weight:700; cursor:pointer;
}
.explore-btn:hover{filter:brightness(.95)}

/* ===== Modal centrale per "explore all taxa" ===== */
.tx-overlay{
  position: fixed; inset: 0;
  background: rgba(0,0,0,.35);
  z-index: 90;
}
.tx-modal{
  position: fixed; z-index: 95;
  top: 50%; left: 50%; transform: translate(-50%, -50%);
  width: min(980px, calc(100vw - 40px));
  max-height: min(82vh, 880px);
  overflow: auto;
  background: #fff; border: 2px solid var(--brand-line); border-radius: 14px;
  box-shadow: 0 24px 64px rgba(0,0,0,.28);
}
.tx-modal-head{
  display:flex; align-items:center; justify-content:space-between;
  padding: 10px 12px; position: sticky; top: 0; background:#fff;
  border-bottom: 1px solid var(--brand-line); z-index: 1;
}
.tx-modal-head strong{font-size:1.05rem;color:#0f5b36}
.tx-modal-close{
  border:1px solid var(--brand); background:var(--brand); color:#fff;
  border-radius:10px; width:34px; height:30px; cursor:pointer; font-weight:800;
}
.tx-modal-body{
  display:grid; grid-template-columns:repeat(2, minmax(0, 1fr)); gap:12px;
  padding: 12px;
}
.tx-card{
  background:#fff; border:1px solid var(--brand-line); border-radius:12px; padding:10px;
}
.tx-card-row{
  display:flex; align-items:center; gap:10px; margin-bottom:8px;
}
.tx-card-subgrid{
  display:flex; flex-wrap:wrap; gap:8px;
}

/* Bottoni circolari nel modal */
.tx-family-btn, .tx-sub-btn{
  width:56px; height:56px; border-radius:50%;
  border:2px solid rgba(34,197,94,0.45);
  background:#fff; display:inline-flex; align-items:center; justify-content:center;
  cursor:pointer; transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
  padding:0; overflow:hidden;
}
.tx-sub-btn{ width:50px; height:50px; }
.tx-family-btn img, .tx-sub-btn img{ width:100%; height:100%; object-fit:cover; display:block; border-radius:50% }
.tx-family-btn.active, .tx-sub-btn.active{ border-color:#2563eb; box-shadow:0 0 0 3px rgba(37,99,235,.18) inset }
.tx-family-btn:hover, .tx-sub-btn:hover{ transform:scale(1.06) }

/* Responsive modal grid */
@media (max-width: 920px){
  .tx-modal-body{ grid-template-columns:1fr; }
}



