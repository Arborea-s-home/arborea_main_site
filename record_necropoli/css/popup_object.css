/* ===== Object Popup – nuovo layout (Leaflet) ============================== */
/* Sblocca i limiti di Leaflet e dimensiona il vero wrapper */
.leaflet-popup.leaflet-popup-object { 
  max-width: none !important;                 /* niente tetto globale */
  filter: drop-shadow(0 0 0.25rem color-mix(in oklab, var(--accent), transparent 70%));
}

.leaflet-popup.leaflet-popup-object .leaflet-popup-content-wrapper {
  border-radius: 10px;
  padding: 0;
  box-shadow: 0 6px 18px rgba(0,0,0,0.16);
  border: 1px solid #e6e6e6;
  background: #fff;

  /* dimensionamento fluido del wrapper */
  min-width: 360px;
  max-width: 800px;
  width: clamp(360px, 70vw, 800px);
}

/* Allarga il contenuto fino a riempire il wrapper (Leaflet mette width/maxWidth) */
.leaflet-popup.leaflet-popup-object .leaflet-popup-content {
  width: 100% !important;       /* occupa tutto il wrapper */
  max-width: none !important;   /* ignora il maxWidth di default (300px) */
  margin: 0 !important;         /* gestiamo noi i padding/margini */
  padding: 0 !important;
  display: block;
}

/* Punta del popup con il colore di accento */
.leaflet-popup.leaflet-popup-object .leaflet-popup-tip {
  background: #fff;
  border: 2px solid var(--accent);
}

/* --- Wrapper contenuti --------------------------------------------------- */

.popup-wrapper.object {
  width: 100%;
  display: flex;
  flex-direction: column;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  color: #222;
}

/* --- Header -------------------------------------------------------------- */

.obj-header {
  display: grid;
  grid-template-columns: minmax(44px, 56px) 1fr minmax(44px, 64px); /* icona | titolo | badge ID */
  gap: 12px;
  align-items: center;
  padding: 12px 14px;
  border-bottom: 1px solid #eee;
  background: #fafafa;
}

/* header icona rimane uguale */
.obj-header-icon {
  width: clamp(44px, 6vw, 64px);
  height: clamp(44px, 6vw, 64px);
  border-radius: 50%;
  border: 2px solid rgba(0,0,0,0.08);
  object-fit: cover;
  display: block;
}

/* titolo tassonomico */
.obj-header-title {
  min-width: 0;
}
.obj-header-precise {
  font-size: clamp(16px, 2.1vw, 20px);
  font-weight: 700;
  color: #111;
  line-height: 1.2;
}
.obj-header-family {
  font-size: clamp(14px, 1.8vw, 16px);
  font-style: italic;
  color: #444;
  margin-top: 2px;
  line-height: 1.2;
}

/* badge Arborea_ID speculare all'icona */
.obj-header-id {
  width: clamp(44px, 6vw, 64px);
  height: clamp(44px, 6vw, 64px);
  border-radius: 50%;
  border: 2px solid rgba(0,0,0,0.08);
  background: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align:center;
  line-height:1.15;
  color:#111;
  font-weight:600;
  font-size:10px;
}

.obj-header-id-label {
  font-size:9px;
  line-height:1.1;
  font-weight:600;
  color:#444;
}

.obj-header-id-val {
  font-size:12px;
  font-weight:700;
  color:#111;
  margin-top:2px;
}

@media (max-width: 520px) {
  .obj-header {
    grid-template-columns: 44px 1fr 44px; /* icona | titolo | badge */
    gap: 10px;
  }
  .obj-header-icon {
    width: 44px;
    height: 44px;
  }
  .obj-header-id {
    width: 44px;
    height: 44px;
    font-size:9px;
  }
  .obj-header-id-val {
    font-size:11px;
  }
  .obj-header-precise {
    font-size: 15px;
  }
  .obj-header-family  {
    font-size: 13px;
  }

  .obj-body {
    grid-template-columns: 1fr;
  }
  .obj-divider { display: none; }
  .obj-col { padding: 8px 2px; }
}

/* --- Body: due colonne + divisore --------------------------------------- */

.obj-body {
  display: grid;
  grid-template-columns: 1.4fr 1px 1fr; /* sinistra un po’ più larga */
  gap: 0;
  padding: 12px 14px 14px;
}

.obj-col { padding: 6px 6px; }

.obj-divider {
  background: #eee;
  width: 1px;
  height: 100%;
}

/* --- Info items ---------------------------------------------------------- */

.popup-info-item { margin-bottom: 12px; }

.popup-info-label {
  font-weight: 700;
  color: #4a6fa5;
  margin-bottom: 4px;
  font-size: 0.8rem;
  letter-spacing: 0.4px;
  text-transform: uppercase;
}

.popup-info-value {
  color: #333;
  line-height: 1.55;
  font-size: 0.95rem;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* Bibliografia: scroll solo nella colonna destra */
.obj-col-right .popup-info-item .popup-info-value {
  max-height: 260px;
  overflow: auto;
  padding-right: 4px;
}

/* --- Links (colonna destra) --------------------------------------------- */

.obj-links {
  display: grid;
  grid-auto-flow: row;
  gap: 10px;
  margin-top: 10px;
}

.obj-link {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  color: #4a6fa5;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.95rem;
}
.obj-link:hover { text-decoration: underline; }

.popup-link-icon {
  font-weight: 700;
  line-height: 1;
}

/* --- Palette precisione tramite CSS variables ---------------------------- */

.leaflet-popup-object,
.object-icon { --accent: #9e9e9e; } /* default/unknown */

.leaflet-popup-object.precision-0,
.object-icon.precision-0 { --accent: #1e88e5; } /* azzurro */
.leaflet-popup-object.precision-1,
.object-icon.precision-1 { --accent: #43a047; } /* verde */
.leaflet-popup-object.precision-2,
.object-icon.precision-2 { --accent: #fdd835; } /* giallo */
.leaflet-popup-object.precision-3,
.object-icon.precision-3 { --accent: #fb8c00; } /* arancione */
.leaflet-popup-object.precision-4,
.object-icon.precision-4 { --accent: #e53935; } /* rosso */
.leaflet-popup-object.precision-unknown,
.object-icon.precision-unknown { --accent: #9e9e9e; } /* grigio */

/* --- Responsive ---------------------------------------------------------- */

@media (min-width: 740px) {
  .popup-info-item { margin-bottom: 14px; }
}
@media (min-width: 640px) {
  .obj-body { grid-template-columns: 1.6fr 1px 1fr; }
}
@media (min-width: 760px) {
  .popup-info-label { font-size: 0.85rem; letter-spacing: 0.45px; }
  .popup-info-item { margin-bottom: 16px; }
}
@media (max-width: 520px) {
  .obj-header {
    grid-template-columns: 44px 1fr;
    gap: 10px;
  }
  .obj-header-icon { width: 44px; height: 44px; }
  .obj-header-precise { font-size: 15px; }
  .obj-header-family  { font-size: 13px; }
  .obj-body { grid-template-columns: 1fr; }
  .obj-divider { display: none; }
  .obj-col { padding: 8px 2px; }
}

/* === FIX popup oggetti: rimuovi colli di bottiglia e allarga contenuto === */

/* 1) Sblocca il tetto globale solo per i popup degli oggetti */
.leaflet-popup.leaflet-popup-object .leaflet-popup-content-wrapper {
  max-width: 800px !important;            /* > del 400px globale */
  min-width: 360px;
  width: clamp(360px, 70vw, 800px);
  border-radius: 10px;
  padding: 0;
}

/* 2) Il contenuto deve riempire tutto il wrapper */
.leaflet-popup.leaflet-popup-object .leaflet-popup-content {
  width: 100% !important;
  max-width: none !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* 3) Togli il cappio a 300px del contenitore interno personalizzato */
.leaflet-popup.leaflet-popup-object .popup-wrapper.object {
  max-width: none !important;   /* era 300px */
  width: 100%;
}

/* (opzionale) punta e alone */
.leaflet-popup.leaflet-popup-object .leaflet-popup-tip {
  background: #fff;
  border: 2px solid var(--accent);
}

.province-map .province-poly {
  /* leggerissimo blur per rendere il bordo più “morbido” */
  filter: blur(1.0px);
}

/* === Lista di chip (smistamento) === */
.obj-chips {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 8px;
  padding: 12px 14px 14px;
}
.obj-chip {
  appearance: none;
  border: 1px solid var(--chip-border, #43a047);    /* verde scuro di default */
  background: var(--chip-bg, #ecfdf5);              /* verde chiarissimo di default */
  border-radius: 999px;
  padding: 8px 12px;
  text-align: left;
  cursor: pointer;
  box-shadow: 0 1px 0 rgba(0,0,0,0.04);
  transition: box-shadow .12s, background-color .12s;
}
.obj-chip:hover {
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  /* al hover possiamo leggermente scurire, ma se vuoi puoi lasciarlo invariato */
  filter: brightness(0.97);
}
.obj-chip-title {
  display:block;
  font-weight:700;
  color:#111;
  font-size:13px;
  line-height:1.2;
}
.obj-chip-sub {
  display:block;
  color:#4b5563;
  font-size:12px;
  line-height:1.2;
}

/* back */
.obj-back { padding: 10px 14px 0; }
.obj-back-btn {
  appearance: none; border: 1px solid #d1d5db; background:#fff; color:#111;
  border-radius:8px; padding:6px 10px; font-weight:700; cursor:pointer;
}
.obj-back-btn:hover { background:#f9fafb; }
.obj-detail { padding: 6px 0 0; }

.no-italic {
  font-style: normal;
}
